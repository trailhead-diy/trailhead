# pnpm configuration for optimal performance

# Use hard links when possible to save disk space
# This can significantly reduce node_modules size
prefer-workspace-packages=true

# Store all packages in a global store and hard link them
# This saves disk space and speeds up installations
store-dir=~/.pnpm-store

# More lenient peer dependency handling for monorepo compatibility
# This prevents Dependabot/Renovate resolution errors
strict-peer-dependencies=false

# Don't hoist packages to the root node_modules
# This ensures better isolation and fewer conflicts
hoist=false

# Use the highest version of a package when there are duplicates
# This reduces bundle size
resolution-mode=highest

# Automatically install peer dependencies
# This prevents "unmet peer dependency" warnings
auto-install-peers=true

# Deduplicate packages after installation
# This reduces node_modules size
dedupe-peer-dependents=true

# Use symlinks for workspace packages
# This ensures changes are immediately reflected
link-workspace-packages=true

# Save exact versions in package.json
# This ensures reproducible builds
save-exact=false

# Enable strict SSL (security best practice)
strict-ssl=true

# Set concurrent network requests
# Adjust based on your network speed
network-concurrency=16

# Security: Delay installation of recently published packages (24 hours)
# Reduces risk of installing compromised packages (new in pnpm 10)
minimum-release-age=1440

# Network performance monitoring (new in pnpm 10)
# Warn if metadata fetch takes longer than 60 seconds
fetch-warn-timeout-ms=60000
# Warn if download speed is below 50 KiB/s
fetch-min-speed-kib-ps=50

# Enable global virtual store for faster installs (experimental)
# Significantly speeds up installations when warm cache is available
enable-global-virtual-store=true

# Enable package provenance when publishing
publish-branch=main

# GitHub Packages Configuration
# Moved to .npmrc.github to avoid warnings when GITHUB_TOKEN is not set
# To publish to GitHub Packages:
# 1. Ensure GITHUB_TOKEN is set in your environment
# 2. Use: pnpm config set @esteban-url:registry https://npm.pkg.github.com
# 3. Or merge .npmrc.github when publishing
