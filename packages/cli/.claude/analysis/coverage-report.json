{
  "version": "2.0",
  "timestamp": "2025-12-23T00:00:00.000Z",
  "gitSha": "4854091",
  "gitBranch": "optimize-action",
  "lastAnalyzedFiles": [
    "packages/cli/src/cli.ts",
    "packages/cli/src/index.ts",
    "packages/cli/src/command/base.ts",
    "packages/cli/src/command/builders.ts",
    "packages/cli/src/command/git-hooks.ts",
    "packages/cli/src/command/index.ts",
    "packages/cli/src/command/patterns.ts",
    "packages/cli/src/command/performance.ts",
    "packages/cli/src/command/types.ts",
    "packages/cli/src/command/validation.ts",
    "packages/cli/src/progress/enhanced-tracker.ts",
    "packages/cli/src/progress/index.ts",
    "packages/cli/src/progress/tracker.ts",
    "packages/cli/src/progress/types.ts",
    "packages/cli/src/prompts/index.ts",
    "packages/cli/src/testing/assertions.ts",
    "packages/cli/src/testing/cli-testing.ts",
    "packages/cli/src/testing/context.ts",
    "packages/cli/src/testing/index.ts",
    "packages/cli/src/testing/interactive.ts",
    "packages/cli/src/testing/performance.ts",
    "packages/cli/src/testing/runner.ts",
    "packages/cli/src/utils/chalk.ts",
    "packages/cli/src/utils/index.ts",
    "packages/cli/src/utils/logger.ts",
    "packages/cli/src/utils/options.ts",
    "packages/cli/src/utils/package-manager.ts",
    "packages/cli/src/utils/spinner.ts",
    "packages/cli/src/utils/stats.ts"
  ],
  "projectType": {
    "language": "TypeScript",
    "framework": "Node.js CLI Framework",
    "testFramework": "Vitest"
  },
  "summary": {
    "behaviorsAnalyzed": 58,
    "fullyCovered": 38,
    "partiallyCovered": 12,
    "notCovered": 8,
    "qualityIssues": 3,
    "coveragePercent": 86
  },
  "gaps": [
    {
      "behavior": "createCLI.run",
      "file": "packages/cli/src/cli.ts:45",
      "risk": "critical",
      "status": "partial",
      "testTypes": { "unit": true, "integration": false, "e2e": false },
      "suggestion": "Add integration test that actually executes CLI.run() with args and verifies command execution, exit codes, and error handling"
    },
    {
      "behavior": "prompts.confirmWithDetails",
      "file": "packages/cli/src/prompts/index.ts:71",
      "risk": "high",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add unit tests mocking @clack/prompts to verify confirmation flow with details display and cancel handling"
    },
    {
      "behavior": "prompts.directoryPrompt",
      "file": "packages/cli/src/prompts/index.ts:117",
      "risk": "high",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add unit tests for directory path validation (rejects .., /, empty paths) and normalization"
    },
    {
      "behavior": "cli-testing.createCLITestRunner",
      "file": "packages/cli/src/testing/cli-testing.ts:23",
      "risk": "high",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add tests for CLI test runner output capture, ANSI stripping, exit code handling"
    },
    {
      "behavior": "interactive.runInteractiveTestRunner",
      "file": "packages/cli/src/testing/interactive.ts:95",
      "risk": "medium",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add integration tests for interactive prompt handling with mock child processes"
    },
    {
      "behavior": "git-hooks.installGitHooks",
      "file": "packages/cli/src/command/git-hooks.ts:25",
      "risk": "high",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add unit tests with mock fs for git hook installation, verification of hook scripts content"
    },
    {
      "behavior": "git-hooks.uninstallGitHooks",
      "file": "packages/cli/src/command/git-hooks.ts:65",
      "risk": "high",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add unit tests for hook removal with proper cleanup verification"
    },
    {
      "behavior": "git-hooks.verifyGitHooks",
      "file": "packages/cli/src/command/git-hooks.ts:100",
      "risk": "medium",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add tests for hook verification logic with various states (installed, missing, outdated)"
    },
    {
      "behavior": "command/performance.measureCommandPerformance",
      "file": "packages/cli/src/command/performance.ts:15",
      "risk": "low",
      "status": "partial",
      "testTypes": { "unit": true, "integration": false, "e2e": false },
      "suggestion": "Existing tests in testing/performance.test.ts cover similar functionality; consider cross-referencing"
    },
    {
      "behavior": "command/patterns.withRetry",
      "file": "packages/cli/src/command/patterns.ts:20",
      "risk": "medium",
      "status": "partial",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add tests for retry logic with configurable attempts, delays, and error conditions"
    },
    {
      "behavior": "command/patterns.withTimeout",
      "file": "packages/cli/src/command/patterns.ts:50",
      "risk": "medium",
      "status": "partial",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add tests for timeout enforcement and cleanup behavior"
    },
    {
      "behavior": "command/patterns.withProgress",
      "file": "packages/cli/src/command/patterns.ts:75",
      "risk": "low",
      "status": "partial",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add tests for progress callback integration"
    },
    {
      "behavior": "utils/options.filterUndefined",
      "file": "packages/cli/src/utils/options.ts:12",
      "risk": "low",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add simple unit tests for undefined filtering behavior"
    },
    {
      "behavior": "utils/options.mergeOptionsWithDefaults",
      "file": "packages/cli/src/utils/options.ts:38",
      "risk": "low",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add unit tests for options merging with undefined preservation"
    },
    {
      "behavior": "utils/options.coerceOptionType",
      "file": "packages/cli/src/utils/options.ts:59",
      "risk": "low",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add unit tests for type coercion (string/number/boolean conversions)"
    },
    {
      "behavior": "utils/options.processCommandOptions",
      "file": "packages/cli/src/utils/options.ts:100",
      "risk": "low",
      "status": "missing",
      "testTypes": { "unit": false, "integration": false, "e2e": false },
      "suggestion": "Add integration tests for full options processing pipeline"
    },
    {
      "behavior": "testing/context.createTestContext",
      "file": "packages/cli/src/testing/context.ts:15",
      "risk": "low",
      "status": "partial",
      "testTypes": { "unit": true, "integration": true, "e2e": false },
      "suggestion": "Good coverage via integration tests; consider explicit unit test for context initialization"
    },
    {
      "behavior": "testing/assertions.assertCommandSuccess",
      "file": "packages/cli/src/testing/assertions.ts:20",
      "risk": "low",
      "status": "partial",
      "testTypes": { "unit": false, "integration": true, "e2e": false },
      "suggestion": "Covered indirectly; explicit assertion behavior tests could improve clarity"
    },
    {
      "behavior": "testing/runner.createTestRunner",
      "file": "packages/cli/src/testing/runner.ts:30",
      "risk": "low",
      "status": "partial",
      "testTypes": { "unit": false, "integration": true, "e2e": false },
      "suggestion": "Covered via integration tests; explicit unit tests could document edge cases"
    },
    {
      "behavior": "builders.buildCommand",
      "file": "packages/cli/src/command/builders.ts:25",
      "risk": "medium",
      "status": "partial",
      "testTypes": { "unit": true, "integration": false, "e2e": false },
      "suggestion": "Add tests for builder chain methods and final command assembly"
    }
  ],
  "qualityIssues": [
    {
      "file": "packages/cli/tests/cli-orchestration.test.ts",
      "issue": "incomplete-coverage",
      "details": "Tests create commands but never execute CLI.run() - assertions only check command creation, not actual orchestration"
    },
    {
      "file": "packages/cli/tests/domain-integration.test.ts",
      "issue": "no-execution",
      "details": "Commands created in action callbacks are never executed - tests verify creation not behavior"
    },
    {
      "file": "packages/cli/tests/error-handling.test.ts",
      "issue": "happy-path-only",
      "details": "Error handling tested at command creation level but not during actual command execution"
    }
  ],
  "coverageMatrix": [
    { "behavior": "createCLI", "unit": true, "integration": false, "e2e": false, "risk": "critical", "status": "partial" },
    { "behavior": "createCommand", "unit": true, "integration": true, "e2e": false, "risk": "critical", "status": "covered" },
    { "behavior": "validateCommandOption", "unit": true, "integration": false, "e2e": false, "risk": "high", "status": "covered" },
    { "behavior": "createProgressTracker", "unit": true, "integration": true, "e2e": false, "risk": "medium", "status": "covered" },
    { "behavior": "createEnhancedProgressTracker", "unit": true, "integration": true, "e2e": false, "risk": "medium", "status": "covered" },
    { "behavior": "updateProgress", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "calculateWeightedProgress", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "detectPackageManager", "unit": true, "integration": false, "e2e": false, "risk": "high", "status": "covered" },
    { "behavior": "getRunCommand", "unit": true, "integration": false, "e2e": false, "risk": "medium", "status": "covered" },
    { "behavior": "execPackageManagerCommand", "unit": true, "integration": false, "e2e": false, "risk": "medium", "status": "covered" },
    { "behavior": "parseSemVer", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "compareSemVer", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "createStats", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "updateStats", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "formatStats", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "getTopOperations", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "monitorPerformance", "unit": true, "integration": false, "e2e": false, "risk": "medium", "status": "covered" },
    { "behavior": "getPerformanceSummary", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "getSlowestReports", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "getPerformanceOutliers", "unit": true, "integration": false, "e2e": false, "risk": "low", "status": "covered" },
    { "behavior": "setupResultMatchers", "unit": true, "integration": true, "e2e": false, "risk": "medium", "status": "covered" },
    { "behavior": "createMockFileSystem", "unit": true, "integration": true, "e2e": false, "risk": "medium", "status": "covered" },
    { "behavior": "confirmWithDetails", "unit": false, "integration": false, "e2e": false, "risk": "high", "status": "missing" },
    { "behavior": "directoryPrompt", "unit": false, "integration": false, "e2e": false, "risk": "high", "status": "missing" },
    { "behavior": "installGitHooks", "unit": false, "integration": false, "e2e": false, "risk": "high", "status": "missing" },
    { "behavior": "uninstallGitHooks", "unit": false, "integration": false, "e2e": false, "risk": "high", "status": "missing" },
    { "behavior": "createCLITestRunner", "unit": false, "integration": false, "e2e": false, "risk": "high", "status": "missing" }
  ],
  "resolved": [],
  "recommendations": {
    "immediate": [
      "Add integration test for CLI.run() that verifies actual command execution and exit codes",
      "Add unit tests for prompts module (confirmWithDetails, directoryPrompt) with @clack/prompts mocked",
      "Add unit tests for git-hooks module (installGitHooks, uninstallGitHooks, verifyGitHooks)"
    ],
    "shortTerm": [
      "Add tests for command/patterns.ts (withRetry, withTimeout, withProgress)",
      "Add tests for utils/options.ts utility functions",
      "Enhance existing tests to actually execute commands rather than just creating them",
      "Add tests for testing/cli-testing.ts and testing/interactive.ts modules"
    ],
    "notes": [
      "Progress tracking (tracker.ts, enhanced-tracker.ts) has excellent test coverage",
      "Package manager detection has comprehensive tests including edge cases",
      "Stats utilities have thorough unit tests with sorting and aggregation",
      "Performance monitoring utilities are well-tested",
      "Many tests focus on command creation but not execution - consider adding execution tests"
    ]
  },
  "history": []
}
